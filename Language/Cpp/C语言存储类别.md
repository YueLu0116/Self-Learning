# C语言存储类别

1. 存储类别由存储期+链接+作用域构成；

2. 作用域：

   * 分为块、函数、函数原型以及文件作用域；
   * 变长数组中形参名才有用，例如`void use_a_VLA(int n, int m, ar[n][m])`，方括号中必须使用在函数原型中已声明的名称；
   * 变量定义在函数外就具有文件作用域，从变量定义处到所在文件末尾均可见。具有文件作用域的变量也被称为**全局变量**。这里的文件实际是**翻译单元（translation unit）**，即源代码文件加所包含的头文件，具有文件作用域的变量作用范围为整个翻译单元。

3. 链接：

   * 分为：外部链接、内部链接和无链接；
   * 无链接变量：具有块、函数以及函数原型作用域的变量都是无链接变量（私有）；
   * 具有文件作用域的变量可以是外部链接（多个翻译单元使用）也可以是内部链接（翻译单元内使用）；

4. 存储期：

   * 分为：静态存储期、线程存储期、自动存储期和动态分配存储期；
   * 静态存储期：这里的静态表示程序执行期间一直存在，而`static`声明的文件作用域变量表示内部链接，在当前翻译单元作用。无论是外部还是内部链接的文件作用域变量都是静态存储期的。
   * 自动存储期：没有以`static`标识的局部变量。

5. 存储类型：

   * 即变量的类型，由存储期、链接以及作用域排列组合产生不同类型。分为：自动、寄存器（register）、静态外部链接、静态内部链接、静态无链接；

   * 使用关键字`auto`显示说明该变量是自动变量，自动变量没有默认初始化，初值不定；

   * 寄存器变量：在**CPU的寄存器**中，访问速度快，加关键字`register`是请求，不一定分配在寄存器上；

   * 静态无链接：即关键字`static`修饰的块作用域变量，自动初始化，静态的意思是在内存中原地不动；

   * 外部链接的静态变量：当前代码文件使用的外部变量定义在另一个代码文件中，需要使用`extern`声明该变量；自动初始化；**定义处只能使用常量进行初始化**，并且只能初始化一次；

   * 内部链接的静态变量：

     ```c
     int traveler = 1;
     static int stayhome = 1;
     int main()
     {
         extern int traverler;
         extern int stayhome;
     }
     ```

     `stayhome`虽然前有`extern`关键字，但仍旧是内部链接的，这里`extern`只是在`main()`中说明该变量定义在别处（函数外）。

6. 存储类别和函数：

   * 函数存储类型分为：外部、静态以及内联；默认（即使无`extern`关键字）为外部类型。

